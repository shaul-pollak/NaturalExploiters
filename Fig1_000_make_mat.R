rm(list=ls())
library(data.table)
library(Matrix)
setDTthreads(0)

tsv <- fread("../output/linclust/0.5.tsv",header=F)
invisible(tsv[,genome := gsub("_\\d+$","",V2)])

tt <- tsv[,.N,by=.(genome,V1)]

ui <- unique(tsv$genome)
i <- match(tsv$genome,ui)
uj <- unique(tsv$V1)
j <- match(tsv$V1,uj)
m <- sparseMatrix(i=i,j=j,x=1)
rownames(m) <- ui
colnames(m) <- uj
save(list="m",file="../output/prot_mat.RData")
