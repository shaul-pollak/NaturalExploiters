###
# preprocessing for figure 1
#
# script to submit the 003_rand_test.R script to a compute node using
# the the SLURM workload manage
###

#!/bin/bash
#SBATCH -N 1
#SBATCH -n 1
#SBATCH -t 12:00:00
#SBATCH -p sched_mit_chisholm,sched_mit_hill,sched_any,newnodes
#SBATCH --array=4951-5000
#SBATCH -J rtest_chi
#SBATCH --output=slurm_out/rtest_%a.out
#SBATCH --mem=50G

OUT_DIR="../output/rand_test"
ANC_PATH="../output/anc.RData"
CHIT_ANC_PATH="../output/chit_anc.RData"
SCRIPT_PATH="003_rand_test.R"

# create OUT_DIR if it does not exist
[ ! -d $OUT_DIR ] && mkdir $OUT_DIR

f="$OUT_DIR/rand_${SLURM_ARRAY_TASK_ID}.RData"

if [ ! -f $f ]; then
	Rscript $SCRIPT_PATH \
		${SLURM_ARRAY_TASK_ID} \
		$ANC_PATH \
    $CHIT_ANC_PATH \
		$OUT_DIR \
		1e2 \
		0
fi
