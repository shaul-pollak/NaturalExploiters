rm(list=ls())
library(openxlsx)
library(svglite)
library(phytools)
library(ggplot2)
library(latex2exp)
library(RColorBrewer)
library(ggtree)
source("functions.R")
load("data/fig4.RData")

####
# plot
####

## richness over time 
o <- order(clsf[,3],rownames(clsf))
rns <- df[,1]
d <- df[,-1]
d[d<1e-3] <- 0
d <- d[,grepl("^C2",colnames(d))]
tplt <- data.frame(cycle=c(0,get_time(colnames(d))),richness=c(44,colSums(d>0)))
p <- ggplot(tplt,aes(cycle*84,richness)) + 
  geom_point(col=adjustcolor("black",alpha.f=.5),position=position_jitter(10)) + 
  stat_summary(fun=mean, geom="point", size=3) +
  stat_summary(fun=mean, geom="line") +
  ylim(0,max(tplt$richness)) +
  scale_x_continuous(breaks=c(0,420,840)) +
  labs(x="Time [h]", y = "Richness") +
  theme_shaul()
ggsave(filename="fig4c.svg",plot=p)
