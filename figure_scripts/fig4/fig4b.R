rm(list=ls())
library(openxlsx)
library(svglite)
library(phytools)
library(ggplot2)
library(latex2exp)
library(RColorBrewer)
library(ggtree)
source("functions.R")
load("data/fig4.RData")

####
# plot
####

## tree
tkp <- c("1A01","3D05","D2M02","A3R06","G3M19","6B07","E3M18",
         "3B05","4B03","B2R09","4F10","G2M07","F2R14","D2R04",
         "F3M07","E3M09","A3M17")
trdf <- data.frame(id=rownames(clsf),clsf=clsf[,3])
sv <- ggtree(tre) %<+% trdf + 
  geom_tippoint(aes(col=clsf)) + 
  geom_tiplab(aes(subset=label %in% tkp),align=T,size=2.1) + 
  scale_color_manual(values=clr) +
  theme(legend.position="none")
ggsave("fig4b.svg",sv,height=2.06,width=1.2)
##
