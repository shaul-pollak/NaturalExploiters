# first input is the concatenated protein file
# second input is the path to the hotpep output file

file=$(realpath $1)
op=$(realpath $2)

[ -d /dev/shm/hotpep ] && rm -rf /dev/shm/hotpep
mkdir /dev/shm/hotpep
currdir=$(pwd)
cd /dev/shm/hotpep
split -l 100000 -a 2 -d $file all
N=$(expr $(ls /dev/shm/hotpep/all* | wc -l) - 1)
# fix this
for i in $(seq 0 $N); do
  let j=$i+1
  [ $i -lt 10 ] && mv all0${i} orfs${j}.txt
  [ $i -gt 9 ] && mv all${i} orfs${j}.txt
done
nt=$(ls /dev/shm/hotpep/orfs*.txt | wc -l)
train_many_organisms_many_families.py /dev/shm/hotpep $nt 1 0.2 2>&1

mv /dev/shm/hotpep/Results/output.txt $op
cd $currdir
rm -rf /dev/shm/hotpep
